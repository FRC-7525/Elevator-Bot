name: Crash

on: 
  push:

jobs:
  Crash:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up JDK
        uses: actions/setup-java@v1
        with:
          java-version: '17'
      - name: Grant execute permission
        run: chmod +x gradlew
      - name: Build robot code
        run: ./gradlew build
      - name: Run Simulation and Capture Logs
        env:                
            CI_NAME: "Crash"
        run: ./gradlew simulateJava | tee simulateJava.log

      - name: Check for Errors in Logs
        run: |
          echo grep -qE simulateJava.log
          if grep -qE "Exception|Error|NULL|NullPointerException" simulateJava.log; then
            echo "Errors detected in simulation logs."
            exit 1
          else
            echo "No errors detected in simulation logs."
          fi
